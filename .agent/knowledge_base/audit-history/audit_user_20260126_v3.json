{
    "audit_id": "audit_user_20260126_111206_v3",
    "module": "user",
    "timestamp": "2026-01-26T11:12:06+07:00",
    "workflow_version": "3.2.2",
    "scores": {
        "overall": 58,
        "grade": "D",
        "dimensions": {
            "UX": {
                "score": 16,
                "max": 20,
                "note": "Missing profile, password change UX"
            },
            "UI": {
                "score": 17,
                "max": 20
            },
            "FE": {
                "score": 15,
                "max": 20,
                "note": "Permission mock, missing features"
            },
            "BE": {
                "score": 14,
                "max": 20,
                "note": "Missing integrations"
            },
            "DA": {
                "score": 15,
                "max": 20,
                "note": "Role as string, no activity_logs table"
            }
        },
        "business_flow": {
            "module_structure": {
                "score": 18,
                "max": 20
            },
            "state_machines": {
                "score": 10,
                "max": 25,
                "note": "User states not implemented"
            },
            "integrations": {
                "score": 10,
                "max": 30,
                "note": "1/4 integrations done"
            },
            "dependencies": {
                "score": 13,
                "max": 15
            },
            "business_rules": {
                "score": 5,
                "max": 10,
                "note": "1/3 rules implemented"
            },
            "total": 56,
            "grade": "D"
        },
        "feature_completeness": {
            "expected": 10,
            "found": 4,
            "missing": 6,
            "score": 47,
            "grade": "F"
        }
    },
    "issues": {
        "total": 17,
        "by_severity": {
            "CRITICAL": 3,
            "HIGH": 6,
            "MEDIUM": 6,
            "LOW": 2
        },
        "by_source": {
            "5-dimension": 6,
            "business_flow": 5,
            "feature_completeness": 6
        },
        "list": [
            {
                "id": "FEAT_CHANGE_PASSWORD",
                "severity": "CRITICAL",
                "category": "FEATURE_GAP",
                "source": "feature_completeness"
            },
            {
                "id": "FLOW_ACTIVITY_LOG",
                "severity": "CRITICAL",
                "category": "BUSINESS_FLOW",
                "source": "business_flow",
                "description": "User→ActivityLog integration không tồn tại"
            },
            {
                "id": "BR052_MISSING",
                "severity": "CRITICAL",
                "category": "BUSINESS_RULE",
                "source": "business_flow",
                "description": "Super Admin self-delete protection không implement"
            },
            {
                "id": "FEAT_MY_PROFILE",
                "severity": "HIGH",
                "category": "FEATURE_GAP",
                "source": "feature_completeness"
            },
            {
                "id": "FEAT_ACTIVITY_LOG",
                "severity": "HIGH",
                "category": "FEATURE_GAP",
                "source": "feature_completeness"
            },
            {
                "id": "FEAT_PERMISSION_PERSISTENCE",
                "severity": "HIGH",
                "category": "FEATURE_GAP",
                "source": "feature_completeness"
            },
            {
                "id": "FLOW_SESSION",
                "severity": "HIGH",
                "category": "BUSINESS_FLOW",
                "source": "business_flow",
                "description": "Session management không rõ ràng"
            },
            {
                "id": "FLOW_PERMISSION_SYNC",
                "severity": "HIGH",
                "category": "BUSINESS_FLOW",
                "source": "business_flow",
                "description": "Permission sync to cache không có"
            },
            {
                "id": "H1",
                "severity": "HIGH",
                "category": "FE",
                "source": "5-dimension",
                "description": "Permission save MOCK only"
            },
            {
                "id": "FEAT_LOGIN_HISTORY",
                "severity": "MEDIUM",
                "category": "FEATURE_GAP",
                "source": "feature_completeness"
            },
            {
                "id": "FLOW_USER_STATES",
                "severity": "MEDIUM",
                "category": "BUSINESS_FLOW",
                "source": "business_flow",
                "description": "User states (ACTIVE/INACTIVE/DELETED) không implement"
            },
            {
                "id": "M1",
                "severity": "MEDIUM",
                "category": "DA",
                "source": "5-dimension",
                "description": "Role as string, not FK"
            },
            {
                "id": "M2",
                "severity": "MEDIUM",
                "category": "BE",
                "source": "5-dimension",
                "description": "No role validation against defined roles"
            },
            {
                "id": "M3",
                "severity": "MEDIUM",
                "category": "FE",
                "source": "5-dimension",
                "description": "Missing user.model.ts"
            },
            {
                "id": "FEAT_EXPORT_DATA",
                "severity": "MEDIUM",
                "category": "FEATURE_GAP",
                "source": "feature_completeness"
            },
            {
                "id": "L1",
                "severity": "LOW",
                "category": "BE",
                "source": "5-dimension",
                "description": "Missing GET single user endpoint"
            },
            {
                "id": "L2",
                "severity": "LOW",
                "category": "FE",
                "source": "5-dimension",
                "description": "Role create client-side only"
            }
        ]
    },
    "business_flow_validation": {
        "flow": "user_flow",
        "integrations_validated": {
            "User_to_ActivityLog": {
                "status": "MISSING",
                "pattern": "log.*login|activity.*log"
            },
            "User_to_Session": {
                "status": "MISSING",
                "pattern": "create.*session|generate.*token"
            },
            "Role_to_Permission": {
                "status": "PARTIAL",
                "pattern": "require_permission ✅, sync NOT"
            }
        },
        "business_rules_validated": {
            "BR050": {
                "status": "PARTIAL",
                "description": "Role check exists but not validated against enum"
            },
            "BR051": {
                "status": "PASS",
                "description": "require_permission implemented"
            },
            "BR052": {
                "status": "FAIL",
                "description": "Super admin self-delete protection missing"
            }
        }
    },
    "prd_generated": {
        "created": true,
        "path": ".agent/prds/IMPROVEMENT-PRD-user-20260126-v3.md",
        "effort_hours": 48
    }
}
# PRD: In Phi·∫øu L∆∞∆°ng C√° Nh√¢n (Individual Payroll Slip)

## 1. B·ªëi c·∫£nh & M·ª•c ti√™u

**V·∫•n ƒë·ªÅ:** Hi·ªán t·∫°i `PayrollItemDetailModal` hi·ªÉn th·ªã chi ti·∫øt l∆∞∆°ng nh√¢n vi√™n nh∆∞ng kh√¥ng c√≥ ch·ª©c nƒÉng in/xu·∫•t PDF phi·∫øu l∆∞∆°ng ri√™ng cho t·ª´ng nh√¢n vi√™n ƒë·ªÉ k√Ω nh·∫≠n.

**CƒÉn c·ª© ph√°p l√Ω:** Kho·∫£n 3 ƒêi·ªÅu 95 B·ªô lu·∫≠t Lao ƒë·ªông 2019 ‚Äî m·ªói l·∫ßn tr·∫£ l∆∞∆°ng, NSDLƒê ph·∫£i cung c·∫•p b·∫£ng k√™ tr·∫£ l∆∞∆°ng ghi r√µ: l∆∞∆°ng c∆° b·∫£n, l∆∞∆°ng OT, l∆∞∆°ng ƒë√™m, c√°c kho·∫£n kh·∫•u tr·ª´.

> [!IMPORTANT]
> **M·ª•c ti√™u:** T·∫°o PDF phi·∫øu l∆∞∆°ng A4 chuy√™n nghi·ªáp cho **1 nh√¢n vi√™n**, in ra ƒë·ªÉ NV k√Ω nh·∫≠n tr·ª±c ti·∫øp.

---

## 2. Mockup Layout (A4 Portrait)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  [LOGO]  ·∫®M TH·ª∞C GIAO TUY·∫æT                         ‚îÇ
‚îÇ  ƒê·ªãa ch·ªâ: ...              ƒêT: ...                   ‚îÇ
‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ
‚îÇ          PHI·∫æU L∆Ø∆†NG TH√ÅNG 02/2026                    ‚îÇ
‚îÇ          K·ª≥: 01/02/2026 ‚Äî 28/02/2026                  ‚îÇ
‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
‚îÇ  H·ªç t√™n:     L√™ VƒÉn T√†i                              ‚îÇ
‚îÇ  Ch·ª©c v·ª•:    Driver          Lo·∫°i: To√†n th·ªùi gian     ‚îÇ
‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
‚îÇ                                                       ‚îÇ
‚îÇ  I. GI·ªú L√ÄM VI·ªÜC                                     ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ Th∆∞·ªùng  ‚îÇ OT    ‚îÇ C.Tu·∫ßn ‚îÇ L·ªÖ ‚îÇ ƒê√™m  ‚îÇT·ªïng ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ 7.3h    ‚îÇ 0.0h  ‚îÇ 0.0h   ‚îÇ0.0h‚îÇ 0.0h ‚îÇ7.3h ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ                                                       ‚îÇ
‚îÇ  II. THU NH·∫¨P                                         ‚îÇ
‚îÇ  L∆∞∆°ng c∆° b·∫£n (√ó 100%)          280.385 ƒë             ‚îÇ
‚îÇ  TƒÉng ca (√ó 150%)                     0 ƒë             ‚îÇ
‚îÇ  Cu·ªëi tu·∫ßn (√ó 200%)                   0 ƒë             ‚îÇ
‚îÇ  Ng√†y l·ªÖ (√ó 300%)                     0 ƒë             ‚îÇ
‚îÇ  ƒê√™m (+30%)                           0 ƒë             ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ             ‚îÇ
‚îÇ  Ph·ª• c·∫•p ƒÉn                     500.000 ƒë             ‚îÇ
‚îÇ  Ph·ª• c·∫•p ƒëi l·∫°i                 300.000 ƒë             ‚îÇ
‚îÇ  Th∆∞·ªüng                               0 ƒë             ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ             ‚îÇ
‚îÇ  T·ªîNG THU NH·∫¨P                1.080.385 ƒë             ‚îÇ
‚îÇ                                                       ‚îÇ
‚îÇ  III. KH·∫§U TR·ª™                                        ‚îÇ
‚îÇ  BHXH, BHYT, BHTN               -86.431 ƒë            ‚îÇ
‚îÇ  T·∫°m ·ª©ng                              0 ƒë             ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ             ‚îÇ
‚îÇ  T·ªîNG KH·∫§U TR·ª™                  -86.431 ƒë            ‚îÇ
‚îÇ                                                       ‚îÇ
‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê          ‚îÇ
‚îÇ  ‚òÖ TH·ª∞C NH·∫¨N:                   993.954 ƒë             ‚îÇ
‚îÇ  (B·∫±ng ch·ªØ: Ch√≠n trƒÉm ch√≠n m∆∞∆°i ba ngh√¨n...)         ‚îÇ
‚îÇ  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê          ‚îÇ
‚îÇ                                                       ‚îÇ
‚îÇ  Ng√†y ... th√°ng ... nƒÉm 2026                          ‚îÇ
‚îÇ                                                       ‚îÇ
‚îÇ  NG∆Ø·ªúI L·∫¨P B·∫¢NG         NG∆Ø·ªúI NH·∫¨N L∆Ø∆†NG              ‚îÇ
‚îÇ  (K√Ω, ghi r√µ h·ªç t√™n)    (K√Ω, ghi r√µ h·ªç t√™n)          ‚îÇ
‚îÇ                                                       ‚îÇ
‚îÇ                                                       ‚îÇ
‚îÇ  _______________         _______________               ‚îÇ
‚îÇ                                                       ‚îÇ
‚îÇ  üìã Lu·∫≠t Lƒê VN: TT 100% | OT 150% | CT 200%         ‚îÇ
‚îÇ                   L·ªÖ 300% | ƒê√™m +30%                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 3. Data Model (ƒë√£ c√≥ s·∫µn 100%)

T·∫•t c·∫£ data c·∫ßn thi·∫øt ƒë√£ c√≥ trong `PayrollItemResponse`:

| Field | M√¥ t·∫£ | Available? |
|-------|--------|:----------:|
| `employee_name` | H·ªç t√™n | ‚úÖ |
| `employee_role` | Ch·ª©c v·ª• | ‚úÖ |
| `is_fulltime` | To√†n th·ªùi gian/Part-time | ‚úÖ |
| `regular_hours` / `overtime_hours` / `weekend_hours` / `holiday_hours` / `night_hours` | Gi·ªù l√†m vi·ªác | ‚úÖ |
| `regular_pay` / `overtime_pay` / `weekend_pay` / `holiday_pay` / `night_pay` | Thu nh·∫≠p | ‚úÖ |
| `allowance_meal` / `allowance_transport` / `bonus` | Ph·ª• c·∫•p | ‚úÖ |
| `gross_salary` | T·ªïng thu nh·∫≠p | ‚úÖ |
| `deduction_social_ins` / `deduction_advance` | Kh·∫•u tr·ª´ | ‚úÖ |
| `total_deductions` | T·ªïng kh·∫•u tr·ª´ | ‚úÖ |
| `net_salary` | Th·ª±c nh·∫≠n | ‚úÖ |

> [!NOTE]
> **Kh√¥ng c·∫ßn thay ƒë·ªïi backend.** T·∫•t c·∫£ data ƒë√£ s·∫µn s√†ng trong frontend.

---

## 4. Proposed Changes

### [MODIFY] [PayrollItemDetailModal.tsx](file:///d:/PROJECT/AM%20THUC%20GIAO%20TUYET/frontend/src/app/(dashboard)/hr/components/PayrollItemDetailModal.tsx)

1. **Th√™m n√∫t "In phi·∫øu l∆∞∆°ng"** v√†o `DialogHeader`
2. **T·∫°o function `printPayrollSlip(item, periodName)`** s·ª≠ d·ª•ng jsPDF tr·ª±c ti·∫øp:
   - Branded header (logo + t√™n c√¥ng ty)
   - Ti√™u ƒë·ªÅ: `PHI·∫æU L∆Ø∆†NG TH√ÅNG MM/YYYY`
   - Th√¥ng tin NV (t√™n, ch·ª©c v·ª•, lo·∫°i Hƒê)
   - B·∫£ng gi·ªù l√†m vi·ªác (5 lo·∫°i + t·ªïng)
   - B·∫£ng thu nh·∫≠p (5 lo·∫°i pay + 3 ph·ª• c·∫•p + t·ªïng)
   - B·∫£ng kh·∫•u tr·ª´ (BHXH + t·∫°m ·ª©ng + t·ªïng)
   - **Th·ª±c nh·∫≠n (bold, highlight)**
   - **S·ªë ti·ªÅn b·∫±ng ch·ªØ** (Vietnamese)
   - Khu v·ª±c ch·ªØ k√Ω: 2 c·ªôt (Ng∆∞·ªùi l·∫≠p / Ng∆∞·ªùi nh·∫≠n l∆∞∆°ng)
   - Footer: tham chi·∫øu lu·∫≠t Lƒê VN

### [NEW] Helper: `numberToVietnameseWords(n: number): string`
- Chuy·ªÉn ƒë·ªïi s·ªë ‚Üí ch·ªØ ti·∫øng Vi·ªát (v√≠ d·ª•: 993.954 ‚Üí "Ch√≠n trƒÉm ch√≠n m∆∞∆°i ba ngh√¨n ch√≠n trƒÉm nƒÉm m∆∞∆°i t∆∞ ƒë·ªìng")
- ƒê·∫∑t trong file ti·ªán √≠ch chung ho·∫∑c inline

### Dependencies
- `jsPDF` ‚Äî ƒë√£ c√†i s·∫µn ‚úÖ
- `Roboto font` (Vietnamese diacritics) ‚Äî ƒë√£ c√≥ trong `use-report-export.ts` ‚úÖ

---

## 5. UX Flow

```mermaid
sequenceDiagram
    actor User
    participant Modal as PayrollItemDetailModal
    participant PDF as jsPDF Engine

    User->>Modal: Click v√†o nh√¢n vi√™n trong b·∫£ng l∆∞∆°ng
    Modal-->>User: Hi·ªÉn th·ªã chi ti·∫øt l∆∞∆°ng
    User->>Modal: Click "In phi·∫øu l∆∞∆°ng" üñ®Ô∏è
    Modal->>PDF: generatePayrollSlip(item, period)
    PDF->>PDF: Render A4 layout + Vietnamese font
    PDF-->>User: window.open(pdf) ho·∫∑c pdf.save()
```

---

## 6. Verification Plan

### Manual Verification
1. M·ªü PayrollItemDetailModal ‚Üí th·∫•y n√∫t "In phi·∫øu l∆∞∆°ng"
2. Click "In phi·∫øu l∆∞∆°ng" ‚Üí PDF m·ªü/t·∫£i v·ªÅ
3. Ki·ªÉm tra PDF: header, th√¥ng tin NV, gi·ªù, thu nh·∫≠p, kh·∫•u tr·ª´, th·ª±c nh·∫≠n
4. Ki·ªÉm tra ch·ªØ k√Ω: 2 khu v·ª±c v·ªõi ƒë∆∞·ªùng k·∫ª
5. Ki·ªÉm tra Vietnamese diacritics hi·ªÉn th·ªã ƒë√∫ng
6. In th·ª≠ tr√™n A4 ‚Üí layout v·ª´a v·∫∑n

---

## 7. Complexity Assessment

| Dimension | Score | Notes |
|-----------|:-----:|-------|
| UX Impact | 3/10 | Simple print action from existing modal |
| Cross-Module | 1/10 | Self-contained, no external dependencies |
| Security | 2/10 | Uses existing permission system |
| Data Complexity | 2/10 | All data already available |
| Integration | 2/10 | Reuses existing jsPDF + Roboto font |
| **Weighted Total** | **2.3** | **Standard mode ‚Äî 1 iteration** |
